<main class="container">
  <div class="row mb-4">
    <div class="col-md-8">
      <h1>Dog Breeds Directory</h1>
    </div>
    <div class="col-md-4">
      <div class="dropdown float-end">
        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
          Sort by: <%= params[:sort]&.humanize || 'Name (A-Z)' %>
        </button>
        <ul class="dropdown-menu">
          <li><%= link_to 'Name (A-Z)', breeds_path(sort: 'name_asc', search: params[:search]), class: "dropdown-item" %></li>
          <li><%= link_to 'Name (Z-A)', breeds_path(sort: 'name_desc', search: params[:search]), class: "dropdown-item" %></li>
          <li><%= link_to 'Group', breeds_path(sort: 'group', search: params[:search]), class: "dropdown-item" %></li>
          <li><%= link_to 'Origin', breeds_path(sort: 'origin', search: params[:search]), class: "dropdown-item" %></li>
        </ul>
      </div>
    </div>
  </div>

  <%= form_with url: breeds_path, method: :get, local: true, class: "mt-3" do |f| %>
    <div class="input-group">
      <%= f.text_field :search, 
          value: params[:search], 
          class: "form-control",
          placeholder: "Search by breed name...",
          "aria-label": "Search breeds" %>
      <%= f.submit "Search", class: "btn btn-primary" %>
      <% if params[:search].present? %>
        <%= link_to "Clear", breeds_path, class: "btn btn-secondary", "aria-label": "Clear search" %>
      <% end %>
    </div>
  <% end %>

  <% if params[:search].present? %>
    <section class="alert alert-info" role="alert">
      <p>Found <%= @breeds.count %> breeds matching '<%= params[:search] %>'</p>
      <%= link_to 'Clear Search', breeds_path, class: 'float-end' %>
    </section>
  <% end %>

  <section class="row row-cols-1 row-cols-md-3 g-4">
    <% @breeds.each do |breed| %>
      <article class="col">
        <div class="card h-100">
          <% if breed.dog_images.first %>
            <%= image_tag breed.dog_images.first.image_url, 
                class: "card-img-top", 
                alt: "Photo of #{breed.name}" %>
          <% end %>
          <div class="card-body">
            <h2 class="card-title h5"><%= breed.name %></h2>
            <dl class="card-text">
              <dt>Group</dt>
              <dd><%= breed.group %></dd>
              <dt>Origin</dt>
              <dd><%= breed.origin %></dd>
            </dl>
            <%= link_to "Learn More", breed_path(breed), 
                class: "btn btn-primary",
                "aria-label": "Learn more about #{breed.name}" %>
          </div>
        </div>
      </article>
    <% end %>
  </section>
</main>
